<!-- This is a simple small integration test to see if a task can be sent through the wifi adapter to the robot who will then complete it.

Publish a big wireless request:
rostopic pub /arc/wifi/requests arc_msgs/WirelessRequest "header:
  seq: 0
  stamp:
    secs: 0
    nsecs: 0
  frame_id: ''
sender_location:
  position:
    x: 0.0
    y: 0.0
    z: 0.0
  orientation:
    x: 0.0
    y: 0.0
    z: 0.0
    w: 0.0
request_type: 0
task:
  task_id: 1
  created: {secs: 5, nsecs: 0}
  task_name: 'explore'
  parameters:
    bools:
    - {name: '', value: false}
    ints:
    - {name: '', value: 0}
    strs:
    - {name: '', value: ''}
    doubles:
    - {name: '', value: 0.0}
    groups:
    - {name: '', state: false, id: 0, parent: 0}
  request_type: 0" 

The robot should start doing the explore task now.
-->

<launch>
  <master auto="start"/>
  <arg name="robot_type" default="debrisbot"/>
  <param name="/use_sim_time" value="true"/>
  <node pkg="map_server" type="map_server" name="map_server" args="$(find arc_stage)/maps/config/test/test_clean_debris_ms.yaml" respawn="false" >
    <param name="frame_id" value="/map" />
  </node> 


<group ns="arc">
<group ns="test_bot">
	
	<!-- The wifi handler -->
	<node pkg="arc_core" type="wifi_handler_node" name="wifi_handler">
    		<param name="max_signal_range" value="5"/>
  	</node>

	<!-- The communication manager -->
  	<node pkg="arc_core" type="communication_manager" name="communication_manager" output="screen"></node>

	<!-- tasks this robot can perform -->
	<node pkg="arc_tasks" type="task_unguided_clean_debris_server" name="task_unguided_clean_debris_server" output="screen"/>
	<node pkg="arc_tasks" type="task_guided_clean_debris_server" name="task_guided_clean_debris_server" output="screen"/>
	<node pkg="arc_tasks" type="task_explore_server" name="task_explore_server" output="screen"/>
<!-- <node pkg="arc_behaviour" type="move_to_goal_ms" name="move_to_goal_ms" output="screen"/> -->
	<!-- the task handler that will manage task requests. -->
	<node pkg="arc_core" type="task_handler" name="task_handler" output="screen">
        	<rosparam param="valid_tasks">["explore", "unguided_clean_debris", "guided_clean_debris"]</rosparam>
    	</node>

	<!-- THE CORE RECRUITMENT MANAGE ROF ROBOT -->
	<node pkg="arc_recruitment_demos" type="minimal_recruitment_manager" name="recruitment_manager" output="screen">
    	</node>

</group>
  <node pkg="arc_stage" type="arc_stage" name="arc_stage" args="-u $(find arc_stage)/world/test_clean_debris_ms.world" respawn="false">
    <param name="base_watchdog_timeout" value="0.2"/>
  </node>
  <include file="$(find arc_control)/launch/robots/$(arg robot_type).launch">
	<arg name="robot_name" value="test_bot"/>
</include>
</group>
</launch>
